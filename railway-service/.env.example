# ============================================
# HalloWa.id Backend Environment Variables
# ============================================
# Version: 3.0.0 (Local Redis Migration)
# Last Updated: 2025-11-18
# Copy this to .env and fill with your actual values
#
# üìã Quick Setup Checklist:
# [ ] 1. Server ID (REQUIRED for multi-server)
# [ ] 2. Supabase credentials (REQUIRED)
# [ ] 3. Local Redis URL (REQUIRED)
# [ ] 4. Internal API key (REQUIRED)
# [ ] 5. Monitoring credentials (OPTIONAL)
#
# üìö For detailed setup, see: docs/REDIS_LOCAL_MIGRATION.md
# ============================================

# ============================================
# üÜî SERVER IDENTIFICATION (Multi-Server)
# ============================================
# REQUIRED for multi-server deployments to prevent device conflicts
# Each server instance MUST have a unique SERVER_ID
#
# Format: alphanumeric, underscores, hyphens, dots only (3-128 chars)
# Examples: server-singapore-1, server-tokyo-1, prod-server-1
#
# If empty, system will auto-detect using:
# 1. RAILWAY_STATIC_URL (Railway deployments)
# 2. HOSTNAME (VPS/Docker)
# 3. Generated ID (fallback)
#
# ‚ö†Ô∏è IMPORTANT: For production multi-server, explicitly set this!
SERVER_ID=

# ============================================
# DATABASE - Supabase PostgreSQL (REQUIRED)
# ============================================
# Get from: https://supabase.com/dashboard/project/YOUR_PROJECT/settings/api
SUPABASE_URL=https://your-project-id.supabase.co
SUPABASE_SERVICE_ROLE_KEY=your_service_role_key_here

# ============================================
# REDIS - Local Redis (REQUIRED)
# ============================================
# Local Redis connection for all operations:
# - QR codes & pairing codes (temporary data)
# - Rate limiting (distributed)
# - Cache (application cache)
# - BullMQ queue (broadcast queue management)
#
# Format: redis://[username]:[password]@[host]:[port]/[db]
#
# üìç For Railway Redis:
#   Get from Railway > Redis Service > Connect
#   Example: redis://default:password@redis.railway.internal:6379
#
# üìç For Dokploy Redis:
#   Get from Dokploy > Redis Service > Connection Details
#   Example: redis://default:dzj7CABAcay5bef@hallowa-redis-baileys-vncaut:6379
#
# üìç For VPS Redis (localhost):
#   Example: redis://localhost:6379
#   Or with password: redis://default:your_password@localhost:6379
#
# ‚ö†Ô∏è IMPORTANT: This is a single connection for ALL Redis operations
#    No need for separate REST API credentials!
REDIS_URL=redis://default:password@localhost:6379

# ============================================
# MULTI-SERVER AUTO-REGISTRATION (OPTIONAL)
# ============================================
# Optional: Custom server details for backend_servers table
# If not set, system will auto-register with default values
#
# SERVER_NAME=My-VPS-Server
# SERVER_URL=https://your-server-url.com
# SERVER_TYPE=vps
# SERVER_REGION=local
# SERVER_MAX_CAPACITY=50
# SERVER_PRIORITY=0


# ============================================
# SERVER CONFIGURATION
# ============================================
# Port for main service (auto-set by Railway, default: 3000)
PORT=3000

# Environment (development, staging, production)
NODE_ENV=production

# Logging Level (error, warn, info, debug)
LOG_LEVEL=info

# ============================================
# SECURITY
# ============================================
# Internal API Key for Edge Function ‚Üî Railway communication (REQUIRED)
# Generate with: openssl rand -base64 32
# Minimum 32 characters for security
INTERNAL_API_KEY=your_internal_api_key_here_minimum_32_characters

# ============================================
# MONITORING & DASHBOARD (OPTIONAL)
# ============================================
# BullMQ Dashboard Configuration
# Access dashboard at: http://localhost:3001/admin/queues

# Port for monitoring dashboard (separate from main app)
MONITORING_PORT=3001

# Dashboard authentication credentials
# ‚ö†Ô∏è CHANGE THESE IN PRODUCTION!
ADMIN_USERNAME=admin
ADMIN_PASSWORD=your_secure_admin_password_here

# ============================================
# OPTIONAL: Session Configuration
# ============================================
# Session timeout in milliseconds (default: 1 hour)
# SESSION_TIMEOUT=3600000

# ============================================
# MIGRATION NOTES:
# ============================================
#
# üéâ Simplified Redis Configuration!
# - Old setup required 3 different credentials (REST URL, REST TOKEN, TCP URL)
# - New setup only needs 1: REDIS_URL
#
# ‚úÖ Single Redis connection handles:
#    - Session management (QR codes, pairing codes)
#    - Rate limiting
#    - Application cache
#    - BullMQ queue (broadcast processing)
#
# üöÄ Benefits:
#    - Lower latency (TCP native vs HTTP REST)
#    - Better performance (no REST API overhead)
#    - Cost savings (local Redis is free)
#    - Simpler configuration (1 variable vs 3)
#
# üìñ For detailed migration guide, see:
#    railway-service/docs/REDIS_LOCAL_MIGRATION.md
#
# ============================================
# REDIS SETUP EXAMPLES:
# ============================================
#
# üê≥ Docker Compose:
#   services:
#     redis:
#       image: redis:7-alpine
#       ports:
#         - "6379:6379"
#   REDIS_URL=redis://localhost:6379
#
# üöÇ Railway:
#   1. Add Redis service from marketplace
#   2. Copy connection string from service details
#   REDIS_URL=redis://default:xxx@redis.railway.internal:6379
#
# üì¶ Dokploy:
#   1. Create Redis service
#   2. Copy connection URL from service page
#   REDIS_URL=redis://default:xxx@your-redis-host:6379
#
# üñ•Ô∏è VPS (systemd):
#   1. Install: apt install redis-server
#   2. Start: systemctl start redis
#   3. Set password in /etc/redis/redis.conf
#   REDIS_URL=redis://localhost:6379
#
# ============================================
